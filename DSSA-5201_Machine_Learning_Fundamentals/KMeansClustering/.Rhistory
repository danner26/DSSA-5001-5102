geom_line() +
geom_point() +
stat_summary(fun.data=mean_cl_normal) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', formula= y~x, color="black") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
stat_summary(fun.data=mean_cl_normal) +
geom_smooth(method='lm', formula= y~x, color="black") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', formula= y~x, color="black") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', formula= y~x, color="grey") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', formula= y~x, color="darkgrey") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', formula= y~x, color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', formula=((y2-y1)/x2-x1), color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', formula=y~x, color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line() +
geom_point() +
geom_smooth(method='lm', color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.5) +
geom_point(size=2) +
geom_smooth(method='lm', color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.5) +
geom_point(size=3) +
geom_smooth(method='lm', color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.5) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen") +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
coef(lm(total~year, data=enrollment_data))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
coef(lm(total~year, data=enrollment_data))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
coef(lm(total~year, data=enrollment_data))
lm(total~year, data=enrollment_data)
coef()
lm(total~year, data=enrollment_data)
coef(lm(total~year, data=enrollment_data))
coef(lm(total~year, data=enrollment_data))
coef(lm(total ~ year, data=enrollment_data))
fit = lm(total ~ year, data=enrollment_data)
summary(fit)
fit = lm(total ~ year1 + year2, data=enrollment_data)
fit = lm(total ~ year, data=enrollment_data)
summary(fit)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4, color=red) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
#Plot of yield per colony compared to honey produced
```{r message=FALSE, fig.width = 10}
#Plot of yield per colony compared to honey produced
```{r message=FALSE, fig.width = 10}
ggplot(enrollment_data, aes(x=year, y=total)) +
geom_bar() +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total)) +
geom_bar() +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_bar() +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year)) +
geom_bar() +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data) +
geom_bar(aes(x=year, y=total)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1, color=red)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1, color=year)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year")
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year", y.size=2)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year", y.size=22)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year", y.text.size=22)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(y.text.size=22)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(base_size=22)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size-22))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=22))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title=element_text(size-22))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title=element_text(size=22))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), axis.title=element_text(size=28))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size-22)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size-22))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=22))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=20))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_line(size=1.25) +
geom_point(size=4) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
library(tidyverse)
library(readr)
library(dplyr)
library(Hmisc)
library(ggplot2)
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5103_Data_Visualization/Week3')
enrollment_data <- read_csv("enrollment.csv")
glimpse(enrollment_data)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Total Enrolled Students", y = "Year", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
fit = lm(total ~ year, data=enrollment_data)
summary(fit)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
library(tidyverse)
library(readr)
library(dplyr)
library(Hmisc)
library(ggplot2)
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5103_Data_Visualization/Week3')
library(tidyverse)
library(readr)
library(dplyr)
library(Hmisc)
library(ggplot2)
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5103_Data_Visualization/Week3')
enrollment_data <- read_csv("enrollment.csv")
glimpse(enrollment_data)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
fit = lm(total ~ year, data=enrollment_data)
summary(fit)
View(enrollment_data)
View(enrollment_data)
library(tidyverse)
library(readr)
library(dplyr)
library(Hmisc)
library(ggplot2)
library(lubridate)
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5103_Data_Visualization/Week3')
gsub("(.*)/(..)$", "\\1/19\\2", enrollment_data$year)
gsub("(.*)/(..)-(.*)/(..)$", "\\1/19\\2-\\1/19\\2", enrollment_data$year)
gsub("20*$", "\\1/19\\2-\\1/19\\2", enrollment_data$year)
gsub("(.*)/(..)-(.*)/(..)$", "\\1/19\\2-\\1/19\\2", enrollment_data$year)
20*
gsub("20*$", "\\1/19\\2-\\1/19\\2", enrollment_data$year)
gsub("20*$", "\\1/19\\2-\\1/19\\2", enrollment_data$year)
gsub("20\\d\\d$", "\\1/19\\2-\\1/19\\2", enrollment_data$year)
gsub("20\\d\\d$", "1", enrollment_data$year)
gsub("20\\d\\d-20\\d\\d$", "1", enrollment_data$year)
gsub("20\\d\\d-(20|)\\d\\d$", "1", enrollment_data$year)
gsub("20\\d\\d-(20|)\\d\\d$", "20\\d\\d", enrollment_data$year)
gsub("20\\d\\d-(20|)\\d\\d$", "1", enrollment_data$year)
gsub("-\\d\\d$", "1", enrollment_data$year)
gsub("-\\d\\d$", "asd", enrollment_data$year)
str_replace(enrollment_data$year, '-\\d\\d$', 'asd')
str_replace(enrollment_data$year, '-\\d\\d$', 'asd&')
str_replace(enrollment_data$year, '-\\d\\d$', 'asd'&)
str_replace(enrollment_data$year, '-\\d\\d$', 'asd\&')
str_replace(enrollment_data$year, '-\\d\\d$', 'asd$&')
str_replace(enrollment_data$year, '20$', 'asd$&')
str_replace(enrollment_data$year, '20$', '')
str_replace(enrollment_data$year, '20\\d$', '')
str_replace(enrollment_data$year, '20', '')
str_replace(enrollment_data$year, '20', '')
str_replace(enrollment_data$year, '-20', '')
str_replace(enrollment_data$year, '20', '')
str_replace(enrollment_data$year, '-20', '-')
enrollment_data$year <- str_replace(enrollment_data$year, '20', '')
str_replace(enrollment_data$year, '-20', '-')
library(tidyverse)
library(readr)
library(dplyr)
library(Hmisc)
library(ggplot2)
library(lubridate)
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5103_Data_Visualization/Week3')
enrollment_data <- read_csv("enrollment.csv")
glimpse(enrollment_data)
enrollment_data$year <- str_replace(enrollment_data$year, '20', '')
enrollment_data$year <- str_replace(enrollment_data$year, '-20', '-')
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
fit = lm(total ~ year, data=enrollment_data)
summary(fit)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
library(tidyverse)
library(readr)
library(dplyr)
library(Hmisc)
library(ggplot2)
library(lubridate)
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5103_Data_Visualization/Week3')
enrollment_data <- read_csv("enrollment.csv")
glimpse(enrollment_data)
enrollment_data$year <- str_replace(enrollment_data$year, '20', '')
enrollment_data$year <- str_replace(enrollment_data$year, '-20', '-')
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
fit = lm(total ~ year, data=enrollment_data)
summary(fit)
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year (2000's)") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
ggplot(enrollment_data, aes(x=year, y=total, group=1)) +
geom_smooth(method='lm', color="darkgreen", size=1.25) +
geom_line(size=1.25) +
geom_point(size=4) +
labs(x = "Academic Year", y = "Total Enrolled Students", title = "Student Enrollment Per Year (2007 - 2019)") +
theme(axis.title.y=element_text(size=16), axis.title.x=element_text(size=16), title = element_text(size=18))
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5201_Machine_Learning_Fundamentals/KMeansClustering')
library(tidyverse)
library(gridExtra)
setwd('C:/Users/danie/_Source/Stockton-DSSA/DSSA-5201_Machine_Learning_Fundamentals/KMeansClustering')
kmeans_cluster <- function(data, square) {
centroids <- data[sample.int(nrow(data), square), ] # create k points
cluster <- rep(0, nrow(data)) # create equal matrix, with 0's so we can track data point
current_stop_val <- Inf
convergence <- FALSE
stop_val= 10e-5
# determine if centroids stopped moving
while (current_stop_val >= stop_val && isFALSE(convergence)) {
# check if current stop value is greater than or equal to stop_val
sapply(current_stop_val, function(val) {
if (val <= stop_val) {
convergence <- TRUE
}
})
previous_centroids <- centroids
for (data_point in 1:nrow(data)) {
min_distance <- Inf # set min_distance to infinity. Ensures closest euclidean distance overwrites val
for (centroid in 1:nrow(centroids)) {
euclidian_distance <- sum((centroids[centroid, ] - data[data_point, ])^2) # calculate distance between centroid and point
# check closest centroid to min_distance
if (euclidian_distance <= min_distance) {
# set to cluster with lowest distance
cluster[data_point] <- centroid
min_distance <- euclidian_distance
}
}
}
# Calculate mean of points in each cluster
for (centroid in 1:nrow(centroids)) {
centroids[centroid, ] <- apply(data[cluster==centroid, , drop=F], 2, mean) # find new centroids based on mean
}
current_stop_val <- vapply((previous_centroids - centroids)^2, mean, FUN.VALUE=1)# Recalculate stop_val to check for centroids to stop moving
}
centroids <- data.frame(centroids, cluster=1:square) # save centroids as x, y centroid
return(list(data=data.frame(data, cluster), centroids=centroids))
}
compute_square <- function(k_means_data, k_values) {
within_sum_squares <- 0.0
for (k_val in 1:k_values) { # for each k_values value
for (k_data in 1:nrow(k_means_data$data)) { # for each row
# if associated data point belongs to the cluster
if (k_means_data$data$cluster[k_data] == k_means_data$centroids$cluster[k_val]) {
# compute distance from cluster to data point. Add to sum
within_sum_squares <- within_sum_squares +
(k_means_data$data$x[k_data] - k_means_data$centroids$x[k_val])^2 +
(k_means_data$data$y[k_data] - k_means_data$centroids$y[k_val])^2
}
}
}
return(within_sum_squares)
}
get_k_means_graphs <- function(max_k, data, plot_k_means=FALSE, plot_elbow=FALSE) {
k_squares <- 2:max_k # Run 2 through max_k given
within_sum_squares <- vector("numeric", length(k_squares)) # Create a vector for the sum of squares
plots <- vector("list", length(k_squares))
for (square in k_squares) {
print(paste0("K is: ", square))
alg <- kmeans_cluster(data, square) # Run kmeans_cluster algorithm
if (plot_k_means) { # Create plot using plot_k_means
data_plot <- rbind(alg$centroids, alg$data)
plot <- ggplot(data_plot, aes(x=x, y=y, color=as.factor(cluster))) +
geom_point() + geom_point(alg$centroids, mapping=aes(x=x, y=y, colour="#6A0500", size=3 )) +
theme(legend.position="none", axis.title=element_blank())
plots[[ square ]] <- plot # add each plot to vector
}
within_sum_squares[square - 1] <- compute_square(alg, square) # calculate sum of squares
print(within_sum_squares[square - 1])
}
if (plot_k_means) {
plots[[1]] <- NULL
title <- paste("Kmeans for K= 2: ", max_k)
grid.arrange(grobs=plots, top=title , ncol=3)
}
dataframe <- data_frame(k_squares, within_sum_squares) # combine k_squares and within_sum_squares for plotting
if (plot_elbow) { # If elbow plot is true, do the plot
print(ggplot(dataframe, aes(x=k_squares, y=within_sum_squares)) +
geom_line() + geom_point() +
labs(title="The Elbow Curve of Clusters", x="Number of Clusters (K)", y="Within groups sum of squares"))
}
}
kmeans_data <-
as.matrix(read.csv("KMeansData_Group1.csv", header=FALSE))
colnames(kmeans_data) <- c("x", "y") # form into matrix
get_k_means_graphs(15, kmeans_data, plot_k_means=TRUE, plot_elbow=TRUE)
